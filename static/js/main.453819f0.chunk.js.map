{"version":3,"sources":["Track/Track.js","Playlist/Playlist.js","Home/Home.js","App.js","index.js"],"names":["Track","className","href","this","props","track","link","name","artists","map","artist","index","key","Component","Playlist","state","playlist","ruri","userID","at","endpoints","authorize","token","users","links","authLink","getLibrary","bind","getUserID","generateAuthLink","getToken","code","scopes","encodeURIComponent","setState","mid","ac","encodedBody","window","btoa","ms","fetch","method","headers","body","then","r","ok","json","console","error","sessionStorage","removeItem","data","access_token","compileList","tracks","items","forEach","object","item","external_urls","spotify","uri","tempPlaylist","push","id","length","onClick","createPlaylist","Home","submitted","getCode","retrieve","handleSubmit","handleUserInput","URLSearchParams","location","search","get","setItem","getItem","e","preventDefault","event","target","value","onSubmit","type","onChange","App","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.453819f0.chunk.js","sourcesContent":["import React, {Component} from 'react';\n\nclass Track extends Component {\n    render() {\n        return (\n            <div className=\"Track\">\n                <div className=\"track-title\">\n                    <a href={this.props.track.link}>{this.props.track.name}</a>\n                </div>\n                <div className=\"track-artist\">\n                    {\n                        this.props.track.artists.map((artist, index) => {\n                            return (<a href={artist.link} key={index}>{artist.name}</a>);\n                        })\n                    }\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Track;\n","import React, {Component} from 'react';\nimport Track from '../Track/Track';\nimport './Playlist.scss';\n\n// TODO Generate a playlist for user, and add custom playlist cover\nclass Playlist extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            playlist: [],\n            ruri: 'https://iguannalin.github.io/spotify-recently-added/',\n            userID: '',\n            at: '',\n            endpoints: {\n                authorize: 'https://accounts.spotify.com/authorize',\n                token: 'https://accounts.spotify.com/api/token',\n                users: 'https://api.spotify.com/v1/'\n            },\n            links: {\n                authLink: ''\n            }\n        };\n        this.getLibrary = this.getLibrary.bind(this);\n        this.getUserID = this.getUserID.bind(this);\n        this.generateAuthLink = this.generateAuthLink.bind(this);\n    };\n\n    componentDidMount() {\n        this.generateAuthLink();\n        this.getToken(this.props.code);\n    }\n\n    generateAuthLink() {\n        const scopes = encodeURIComponent('user-library-read playlist-modify-private');\n        this.setState({\n            links: {\n                authLink: (this.state.endpoints.authorize + '?client_id=' + this.props.mid + '&response_type=code&redirect_uri=' + this.state.ruri + '&scope=' + scopes)\n            }\n        });\n    }\n\n    getToken(ac) {\n        const encodedBody = window.btoa(this.props.mid + ':' + this.props.ms);\n\n\n        fetch(this.state.endpoints.token, {\n            method: 'POST',\n            'Access-Control-Allow-Headers': {\n                'mode': 'no-cors',\n                'access-control-allow-origin': '*'\n            },\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded',\n                'Authorization': `Basic ${encodedBody}`\n            },\n            body: `grant_type=authorization_code&code=${ac}&redirect_uri=${this.state.ruri}`,\n        })\n            .then(r => {\n                if (r.ok) return r.json();\n                else {\n                    console.error('Error: getToken');\n                    sessionStorage.removeItem('mcode');\n                }\n            })\n            .then(data => {\n                if (data && data.access_token) {\n                    this.setState({\n                        at: data.access_token\n                    });\n                    this.getLibrary();\n                }\n            });\n    }\n\n    getLibrary() {\n\n        fetch('https://api.spotify.com/v1/me/tracks?limit=20', {\n            'Access-Control-Allow-Headers': {\n                'mode': 'no-cors',\n                'access-control-allow-origin': '*'\n            },\n            headers: {\n                'Authorization': `Bearer ${this.state.at}`\n            }\n        })\n            .then(r => {\n                if (r.ok) {\n                    return r.json();\n                } else {\n                    console.error('Error: getLibrary');\n                }\n            })\n            .then(data => {\n                if (data) this.compileList(data);\n            })\n            .then(() => {\n                this.getUserID();\n            });\n    }\n\n    compileList(tracks) {\n        this.setState(() => {\n            return {playlist: []}\n        });\n\n        if (tracks && tracks.items) {\n            tracks.items.forEach(object => {\n                    const item = object.track;\n                    const track = {\n                        name: item.name,\n                        link: item.external_urls.spotify,\n                        artists: item.artists.map(artist => {\n                            return {name: artist.name, link: artist.external_urls.spotify}\n                        }),\n                        uri: item.uri\n                    };\n                    const tempPlaylist = this.state.playlist;\n                    tempPlaylist.push(track);\n                    this.setState(() => {\n                        return {\n                            playlist: tempPlaylist\n                        }\n                    })\n                }\n            );\n        }\n    }\n\n    createPlaylist() {\n\n        fetch(this.state.endpoints.users + 'users/' + this.state.userID + '/playlists', {\n            method: 'POST',\n            'Access-Control-Allow-Headers': {\n                'mode': 'no-cors',\n                'access-control-allow-origin': '*'\n            },\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${this.state.at}`\n            }\n        })\n            .then(r => {\n                if (r.ok) return r.json();\n                else console.error('Error: createPlaylist');\n            })\n            .then(data => {\n                if (data) return;\n            });\n    }\n\n    getUserID() {\n\n        fetch((this.state.endpoints.users + 'me'), {\n            'Access-Control-Allow-Headers': {\n                'mode': 'no-cors',\n                'access-control-allow-origin': '*'\n            },\n            headers: {\n                'Authorization': `Bearer ${this.state.at}`\n            }\n        })\n            .then(r => {\n                if (r.ok) return r.json();\n                else console.error('Error: getUserID');\n            })\n            .then(data => {\n                    if (data) {\n                        this.setState({userID: data.id});\n\n                    }\n                }\n            );\n    }\n\n    compileList(tracks) {\n        this.setState(() => {\n            return {playlist: []}\n        });\n\n        if (tracks && tracks.items) {\n            tracks.items.forEach(object => {\n                    const item = object.track;\n                    const track = {\n                        name: item.name,\n                        link: item.external_urls.spotify,\n                        artists: item.artists.map(artist => {\n                            return {name: artist.name, link: artist.external_urls.spotify}\n                        }),\n                        uri: item.uri\n                    };\n                    const tempPlaylist = this.state.playlist;\n                    tempPlaylist.push(track);\n                    this.setState(() => {\n                        return {\n                            playlist: tempPlaylist\n                        }\n                    })\n                }\n            );\n        }\n    }\n\n    render() {\n        const authLink = this.generateAuthLink();\n        return (\n            <div className=\"Playlist\">\n                {this.state.playlist.length > 0 ? (\n                    <div className=\"button-div position-right\">\n                        <button className=\"button-link\" onClick={this.createPlaylist}>Create this playlist on Spotify\n                            for me\n                        </button>\n                    </div>) : (\n                    <div className=\"button-div\"><a href={this.state.links.authLink}>Click on me to authorize Spotify</a>\n                    </div>\n                )}\n                <ul>\n                    {this.state.playlist.map(\n                        (track, index) => {\n                            return (\n                                <li key={index}><Track track={track}/></li>\n                            )\n                        }\n                    )\n                    }\n                </ul>\n            </div>\n        );\n    }\n}\n\nexport default Playlist;\n","import React, {Component} from 'react';\nimport Playlist from '../Playlist/Playlist';\n\nclass Home extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            mid: '',\n            ms: '',\n            code: '',\n            submitted: false\n        };\n\n        this.getCode = this.getCode.bind(this);\n        this.retrieve = this.retrieve.bind(this);\n        this.handleSubmit = this.handleSubmit.bind(this);\n        this.handleUserInput = this.handleUserInput.bind(this);\n    }\n\n    componentDidMount() {\n        this.getCode();\n        this.retrieve();\n    }\n\n\n    getCode() {\n        const urlParams = new URLSearchParams(window.location.search);\n        const code = urlParams.get('code');\n        this.setState({\n            code: code,\n            submitted: !!(code)\n        });\n        sessionStorage.setItem('mcode', code);\n    }\n\n    retrieve() {\n        // TODO: implement a reset sessionStorage, in case user wants to change ID\n        if (!this.state.mid && sessionStorage.getItem('mid')) {\n            this.setState({\n                mid: sessionStorage.getItem('mid'),\n                ms: sessionStorage.getItem('ms')\n            });\n        }\n    }\n\n    handleSubmit(e) {\n        if (e) {\n            e.preventDefault();\n        }\n        this.setState({\n            submitted: true\n        });\n    }\n\n    handleUserInput(event) {\n        if (event.target.name === 'mid') {\n            this.setState({\n                mid: event.target.value\n            });\n            sessionStorage.setItem('mid', event.target.value);\n        } else if (event.target.name === 'ms') {\n            this.setState({\n                ms: event.target.value\n            });\n            sessionStorage.setItem('ms', event.target.value);\n        }\n    }\n\n    render() {\n        if ((this.state.mid && this.state.ms) || (this.state.submitted || this.state.code)) {\n            return (\n                <div className=\"Home\">\n                    <Playlist mid={this.state.mid} ms={this.state.ms} code={this.state.code}/>\n                </div>\n            )\n        } else {\n            return (\n                <div className=\"login-form\">\n                    <div className=\"login-form card\">\n                        <h2>To use this app, enter your client ID & secret here:</h2>\n                        <form onSubmit={this.handleSubmit}>\n                            <div>\n                                <label>Client ID:\n                                    <input type=\"text\" name=\"mid\" onChange={this.handleUserInput}/></label>\n                            </div>\n                            <div>\n                                <label>Secret:\n                                    <input type=\"text\" name=\"ms\" onChange={this.handleUserInput}/></label>\n                            </div>\n                            <div className=\"login-form buttons\">\n                                <input type=\"submit\" value=\"Submit\"/>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            )\n        }\n    }\n}\n\nexport default Home\n","import React from 'react';\nimport './App.css';\nimport Home from './Home/Home';\n\nfunction App() {\n    return (\n        <div className=\"App\">\n            <Home/>\n        </div>\n    );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}